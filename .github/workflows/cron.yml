name: Check Deadlines

on:
    schedule:
        # 1時間に1回実行 (毎時5分)
        - cron: "5 * * * *"
    workflow_dispatch: # 手動実行ボタンも有効化

jobs:
    cron:
        runs-on: ubuntu-latest
        steps:
            - name: Call Backend Cron Endpoint
              run: |
                  if [ -z "${{ secrets.RENDER_EXTERNAL_HOSTNAME }}" ]; then
                    echo "::error::RENDER_EXTERNAL_HOSTNAME secret is not set. Please set it in Settings > Secrets and variables > Actions."
                    exit 1
                  fi
                  curl -X POST ${{ secrets.RENDER_EXTERNAL_HOSTNAME }}/api/cron/check \
                  -H "Authorization: Bearer ${{ secrets.CRON_SECRET }}" \
                  -H "Content-Type: application/json"
